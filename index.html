<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>IPA Dictionary and Keyboard</title>
  <style>
    #ipa-keyboard {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 20px;
    }
    #ipa-keyboard button {
      font-size: 24px;
      padding: 10px;
      cursor: pointer;
    }
    #ipa-input {
      font-size: 24px;
      padding: 10px;
      width: 50%;
      height: 40px;
    }
    .audio-container {
      margin-top: 20px;
    }
    .audio-container button {
      margin-right: 10px;
    }
  </style>
</head>
<body>
  <h1>IPA Keyboard and Dictionary</h1>
  
  <!-- IPA Keyboard for inserting IPA characters -->
  <div id="ipa-keyboard"></div>

  <!-- Input field where IPA characters will be inserted -->
  <input type="text" id="ipa-input" placeholder="Click buttons to insert IPA characters">

  <h2>IPA Dictionary</h2>

  <div id="mp3-list"></div>

  <script>
    // Function to insert IPA character into the input field
    function insertIPA(char) {
      const input = document.getElementById('ipa-input');
      const start = input.selectionStart;
      const end = input.selectionEnd;
      const before = input.value.substring(0, start);
      const after = input.value.substring(end);
      input.value = before + char + after;
      input.focus();
      input.selectionStart = input.selectionEnd = start + char.length;
    }

    // Function to fetch and display the mp3 dictionary with audio controls
    fetch('mp3_dict.json')
      .then(response => response.json())
      .then(mp3Dict => {
        const container = document.getElementById('mp3-list');
        const ipaSet = new Set();

        // Extract unique IPA characters from the dictionary
        for (const data of Object.values(mp3Dict)) {
          const ipaChars = data.ipa.replace(/[^a-zA-Z0-9\u00C0-\u024F\u0250-\u02AF\u1E00-\u1EFF]/g, ''); // Remove non-IPA characters
          for (const char of ipaChars) {
            ipaSet.add(char);
          }
        }

        // Generate IPA buttons dynamically
        const keyboardContainer = document.getElementById('ipa-keyboard');
        ipaSet.forEach(char => {
          const button = document.createElement('button');
          button.textContent = char;
          button.onclick = () => insertIPA(char);
          keyboardContainer.appendChild(button);
        });

        // Display words and audio controls
        for (const [word, data] of Object.entries(mp3Dict)) {
          const div = document.createElement('div');
          const title = document.createElement('p');
          title.textContent = `${word} (${data.ipa})`;

          const audio = document.createElement('audio');
          audio.controls = true;
          audio.src = data.audio;

          div.appendChild(title);
          div.appendChild(audio);
          container.appendChild(div);
        }
      })
      .catch(err => console.error('Failed to load the mp3 dictionary:', err));
  </script>
</body>
</html>
